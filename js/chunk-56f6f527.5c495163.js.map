{"version":3,"sources":["webpack:///./src/views/home/editCommodity.vue?6945","webpack:///./node_modules/core-js/modules/es.array.filter.js","webpack:///./node_modules/core-js/modules/es.array.find.js","webpack:///./src/views/home/editCommodity.vue?6713","webpack:///src/views/home/editCommodity.vue","webpack:///./src/views/home/editCommodity.vue?9421","webpack:///./src/views/home/editCommodity.vue"],"names":["$","$filter","filter","arrayMethodHasSpeciesSupport","arrayMethodUsesToLength","HAS_SPECIES_SUPPORT","USES_TO_LENGTH","target","proto","forced","callbackfn","this","arguments","length","undefined","$find","find","addToUnscopables","FIND","SKIPS_HOLES","Array","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","on","$event","$router","back","_v","ref","product","rule","staticStyle","model","value","callback","$$v","$set","expression","class","disabled","uploadDisabled","imgUploadUrl","handlePreview","handleRemove","handleSuccesspic","picFile","onChange","typeChange","tid","_l","item","key","tname","downAge","ageType","upAge","handleSuccesspics","picsList","onSubmit","imgPreview","imgPreviewUrl","staticRenderFns","components","card","data","namecheck","Error","typecheck","timecheck","pName","price","type","pic","picUrls","intro","pname","age","computed","typelist","$store","state","methods","$refs","form","validate","valid","url","method","transformRequest","headers","res","code","message","fileList","console","log","timePackage","timeMap","$axios","params","fileUrl","file","purl","slice","push","ageConvert","created","$route","query","pid","component"],"mappings":"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","file":"js/chunk-56f6f527.5c495163.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./editCommodity.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./editCommodity.vue?vue&type=style&index=0&lang=less&\"","'use strict';\nvar $ = require('../internals/export');\nvar $filter = require('../internals/array-iteration').filter;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('filter');\n// Edge 14- issue\nvar USES_TO_LENGTH = arrayMethodUsesToLength('filter');\n\n// `Array.prototype.filter` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.filter\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    return $filter(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\nvar USES_TO_LENGTH = arrayMethodUsesToLength(FIND);\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES || !USES_TO_LENGTH }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{staticClass:\"editCommodity-wrapper\"},[_c('card',{attrs:{\"title\":\"新增商品\"}},[_c('el-button',{staticClass:\"card-btn\",attrs:{\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":function($event){return _vm.$router.back(-1)}}},[_vm._v(\"返回\")]),_c('el-form',{ref:\"form\",staticClass:\"commodity-form\",attrs:{\"model\":_vm.product,\"label-width\":\"100px\",\"rules\":_vm.rule}},[_c('el-form-item',{attrs:{\"label\":\"商品名称\",\"prop\":\"pname\"}},[_c('el-input',{staticStyle:{\"width\":\"300px\"},model:{value:(_vm.product.pName),callback:function ($$v) {_vm.$set(_vm.product, \"pName\", $$v)},expression:\"product.pName\"}})],1),_c('el-form-item',{attrs:{\"label\":\"商品价格\",\"prop\":\"price\"}},[_c('el-input-number',{attrs:{\"step\":0.1,\"precision\":1},model:{value:(_vm.product.price),callback:function ($$v) {_vm.$set(_vm.product, \"price\", $$v)},expression:\"product.price\"}})],1),_c('el-form-item',{attrs:{\"label\":\"商品详情图\",\"prop\":\"pic\"}},[_c('el-upload',{ref:\"upload\",class:{ disabled: _vm.uploadDisabled },attrs:{\"action\":_vm.imgUploadUrl,\"on-preview\":_vm.handlePreview,\"on-remove\":_vm.handleRemove,\"on-success\":_vm.handleSuccesspic,\"file-list\":_vm.picFile,\"list-type\":\"picture-card\",\"limit\":1,\"on-change\":_vm.onChange}},[_c('i',{staticClass:\"el-icon-plus\"})])],1),_c('el-form-item',{attrs:{\"label\":\"商品类型\",\"prop\":\"tid\"}},[_c('el-select',{staticClass:\"select-type\",attrs:{\"placeholder\":\"请选择\"},on:{\"change\":_vm.typeChange},model:{value:(_vm.tid),callback:function ($$v) {_vm.tid=$$v},expression:\"tid\"}},_vm._l((_vm.typelist),function(item){return _c('el-option',{key:item.tid,attrs:{\"label\":item.tname,\"value\":item.tid}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"适用年龄\",\"prop\":\"age\"}},[_c('el-input-number',{attrs:{\"step\":1},model:{value:(_vm.downAge),callback:function ($$v) {_vm.downAge=$$v},expression:\"downAge\"}}),_c('el-select',{staticClass:\"select-data\",attrs:{\"placeholder\":\"请选择\"},model:{value:(_vm.ageType[0]),callback:function ($$v) {_vm.$set(_vm.ageType, 0, $$v)},expression:\"ageType[0]\"}},[_c('el-option',{attrs:{\"label\":\"天\",\"value\":0}}),_c('el-option',{attrs:{\"label\":\"月\",\"value\":1}}),_c('el-option',{attrs:{\"label\":\"年\",\"value\":2}})],1),_vm._v(\" — \"),_c('el-input-number',{attrs:{\"step\":1},model:{value:(_vm.upAge),callback:function ($$v) {_vm.upAge=$$v},expression:\"upAge\"}}),_c('el-select',{staticClass:\"select-data\",attrs:{\"placeholder\":\"请选择\"},model:{value:(_vm.ageType[1]),callback:function ($$v) {_vm.$set(_vm.ageType, 1, $$v)},expression:\"ageType[1]\"}},[_c('el-option',{attrs:{\"label\":\"天\",\"value\":0}}),_c('el-option',{attrs:{\"label\":\"月\",\"value\":1}}),_c('el-option',{attrs:{\"label\":\"年\",\"value\":2}})],1)],1),_c('el-form-item',{attrs:{\"label\":\"图片描述\",\"prop\":\"pics\"}},[_c('el-upload',{ref:\"upload\",attrs:{\"action\":_vm.imgUploadUrl,\"on-preview\":_vm.handlePreview,\"on-remove\":_vm.handleRemove,\"on-success\":_vm.handleSuccesspics,\"file-list\":_vm.picsList,\"list-type\":\"picture-card\",\"multiple\":true}},[_c('i',{staticClass:\"el-icon-plus\"})])],1),_c('el-form-item',{attrs:{\"label\":\"文字描述\",\"prop\":\"intro\"}},[_c('el-input',{staticStyle:{\"width\":\"500px\"},attrs:{\"type\":\"textarea\"},model:{value:(_vm.product.intro),callback:function ($$v) {_vm.$set(_vm.product, \"intro\", $$v)},expression:\"product.intro\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onSubmit}},[_vm._v(\"确定\")])],1)],1)],1),_c('el-dialog',{attrs:{\"visible\":_vm.imgPreview},on:{\"update:visible\":function($event){_vm.imgPreview=$event}}},[_c('img',{attrs:{\"width\":\"100%\",\"src\":_vm.imgPreviewUrl,\"alt\":\"\"}})])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <section class=\"editCommodity-wrapper\">\n    <card title=\"新增商品\">\n      <el-button\n        class=\"card-btn\"\n        size=\"small\"\n        type=\"primary\"\n        @click=\"$router.back(-1)\"\n        >返回</el-button\n      >\n      <el-form\n        ref=\"form\"\n        :model=\"product\"\n        label-width=\"100px\"\n        class=\"commodity-form\"\n        :rules=\"rule\"\n      >\n        <el-form-item label=\"商品名称\" prop=\"pname\">\n          <el-input v-model=\"product.pName\" style=\"width:300px\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"商品价格\" prop=\"price\">\n          <el-input-number\n            v-model=\"product.price\"\n            :step=\"0.1\"\n            :precision=\"1\"\n          ></el-input-number>\n        </el-form-item>\n        <el-form-item label=\"商品详情图\" prop=\"pic\">\n          <el-upload\n            :action=\"imgUploadUrl\"\n            :on-preview=\"handlePreview\"\n            :on-remove=\"handleRemove\"\n            :on-success=\"handleSuccesspic\"\n            :file-list=\"picFile\"\n            list-type=\"picture-card\"\n            ref=\"upload\"\n            :limit=\"1\"\n            :class=\"{ disabled: uploadDisabled }\"\n            :on-change=\"onChange\"\n          >\n            <i class=\"el-icon-plus\"></i>\n          </el-upload>\n        </el-form-item>\n        <el-form-item label=\"商品类型\" prop=\"tid\">\n          <el-select\n            v-model=\"tid\"\n            placeholder=\"请选择\"\n            class=\"select-type\"\n            @change=\"typeChange\"\n          >\n            <el-option\n              v-for=\"item in typelist\"\n              :key=\"item.tid\"\n              :label=\"item.tname\"\n              :value=\"item.tid\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"适用年龄\" prop=\"age\">\n          <el-input-number v-model=\"downAge\" :step=\"1\"></el-input-number>\n          <el-select\n            v-model=\"ageType[0]\"\n            placeholder=\"请选择\"\n            class=\"select-data\"\n          >\n            <el-option label=\"天\" :value=\"0\"></el-option>\n            <el-option label=\"月\" :value=\"1\"></el-option>\n            <el-option label=\"年\" :value=\"2\"></el-option>\n          </el-select>\n          —\n          <el-input-number v-model=\"upAge\" :step=\"1\"></el-input-number>\n          <el-select\n            v-model=\"ageType[1]\"\n            placeholder=\"请选择\"\n            class=\"select-data\"\n          >\n            <el-option label=\"天\" :value=\"0\"></el-option>\n            <el-option label=\"月\" :value=\"1\"></el-option>\n            <el-option label=\"年\" :value=\"2\"></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"图片描述\" prop=\"pics\">\n          <el-upload\n            :action=\"imgUploadUrl\"\n            :on-preview=\"handlePreview\"\n            :on-remove=\"handleRemove\"\n            :on-success=\"handleSuccesspics\"\n            :file-list=\"picsList\"\n            list-type=\"picture-card\"\n            ref=\"upload\"\n            :multiple=\"true\"\n          >\n            <i class=\"el-icon-plus\"></i>\n          </el-upload>\n        </el-form-item>\n        <el-form-item label=\"文字描述\" prop=\"intro\">\n          <el-input\n            type=\"textarea\"\n            v-model=\"product.intro\"\n            style=\"width:500px\"\n          ></el-input>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"onSubmit\">确定</el-button>\n        </el-form-item>\n      </el-form>\n    </card>\n    <el-dialog :visible.sync=\"imgPreview\">\n      <img width=\"100%\" :src=\"imgPreviewUrl\" alt=\"\" />\n    </el-dialog>\n  </section>\n</template>\n\n<script>\nimport card from \"../../components/card\";\nexport default {\n  components: {\n    card\n  },\n  data() {\n    var namecheck = (rule, value, callback) => {\n      if (!this.product.pName) {\n        callback(new Error(\"请填写商品名称\"));\n      } else {\n        callback();\n      }\n    };\n\n    var typecheck = (rule, value, callback) => {\n      if (!this.tid) {\n        callback(new Error(\"请选择商品类型\"));\n      } else {\n        callback();\n      }\n    };\n    var timecheck = (rule, value, callback) => {\n      this.timePackage();\n      if (this.product.upAge < this.product.downAge) {\n        callback(new Error(\"适用年龄格式错误\"));\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      imgUploadUrl: \"http://212.64.87.193:8080/back/product/uploadImage\",\n      imgPreviewUrl: \"\",\n      imgPreview: false,\n      picFile: [],\n      picsList: [],\n      tid: \"\",\n      product: {\n        pName: \"\",\n        price: 0,\n        downAge: 0,\n        upAge: 0,\n        type: {\n          tid: 0,\n          tname: \"\"\n        },\n        pic: \"\",\n        picUrls: [],\n        intro: \"\"\n      },\n      ageType: [0, 0],\n      downAge: 0,\n      upAge: 0,\n      rule: {\n        pname: [\n          {\n            validator: namecheck,\n            trigger: \"blur\"\n          }\n        ],\n        tid: [\n          {\n            validator: typecheck,\n            trigger: \"change\"\n          }\n        ],\n        age: [\n          { validator: timecheck, trigger: \"blur\" },\n          { validator: timecheck, trigger: \"change\" }\n        ]\n      },\n      uploadDisabled: false\n    };\n  },\n  computed: {\n    typelist() {\n      return this.$store.state.typelist;\n    }\n  },\n  methods: {\n    onSubmit() {\n      this.$refs.form.validate(valid => {\n        if (valid) {\n          this.timePackage();\n\n          let url = this.$route.query.pid\n            ? \"/back/product/updateProduct\"\n            : \"/back/product/addProduct\";\n\n          this.$axios({\n            url: url,\n            method: \"post\",\n            transformRequest: [\n              function(data) {\n                return JSON.stringify(data);\n              }\n            ],\n            data: this.product,\n            headers: { \"Content-Type\": \"application/json\" }\n          }).then(res => {\n            if (res.data.code == 200) {\n              this.$message({\n                type: \"success\",\n                message: this.$route.query.pid\n                  ? \"修改商品信息成功\"\n                  : \"添加商品成功\"\n              });\n              this.$router.back(-1);\n            } else {\n              this.$message({\n                type: \"error\",\n                message: \"添加商品失败\"\n              });\n            }\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    onChange(file, fileList) {\n      this.uploadDisabled = fileList.length ? true : false;\n      console.log(fileList);\n    },\n    timePackage() {\n      const timeMap = [1, 30, 365];\n      this.product.downAge = this.downAge * timeMap[this.ageType[0]];\n      this.product.upAge = this.upAge * timeMap[this.ageType[1]];\n    },\n\n    typeChange(val) {\n      let tid = Number(val);\n      this.product.type.tid = tid;\n      this.product.type.tname = this.typelist.find(\n        item => item.tid == tid\n      ).tname;\n    },\n\n    handleRemove(file, fileList) {\n      this.$axios({\n        url: \"/back/product/deleteImage\",\n        params: {\n          fileUrl: file.url\n        }\n      }).then(res => {\n        this.product.pic === file.url.slice(7) && (this.product.pic = \"\");\n        this.uploadDisabled = this.product.pic.length ? true : false;\n        this.product.picUrls = this.product.picUrls.filter(item => {\n          return item.purl !== file.url.slice(7);\n        });\n        if (res.data.code == 200) {\n          this.$message({\n            type: \"success\",\n            message: \"移除成功\"\n          });\n        } else {\n          this.$message({\n            type: \"error\",\n            message: \"移除失败\"\n          });\n        }\n      });\n    },\n    handlePreview(file) {\n      this.imgPreviewUrl = file.url;\n      this.imgPreview = true;\n    },\n    handleSuccesspic(res, file, fileList) {\n      this.product.pic = res.data;\n    },\n    handleSuccesspics(res, file, fileList) {\n      this.product.picUrls.push({ purl: res.data });\n    },\n    ageConvert(age, type) {\n      if (age / 365 > 0 && age % 365 == 0) {\n        this.ageType[type] = 2;\n        return age / 365;\n      } else if (age / 365 > 0 && age % 365 !== 0) {\n        if (age % 30 == 0) {\n          this.ageType[type] = 1;\n          return age / 30;\n        } else {\n          this.ageType[type] = 0;\n          return age;\n        }\n      } else if (age >= 30 && age < 365) {\n        if (age % 30 == 0) {\n          this.ageType[type] = 1;\n          return age / 30;\n        } else {\n          this.ageType[type] = 0;\n          return age;\n        }\n      } else {\n        this.ageType[type] = 0;\n        return age;\n      }\n    }\n  },\n  created() {\n    if (this.$route.query.pid) {\n      this.product = this.$store.state.product;\n      this.picFile = this.product.pic\n        ? [{ name: \"0\", url: \"http://\" + this.product.pic }]\n        : [];\n      this.uploadDisabled = this.picFile.length;\n      for (let item of this.product.picUrls) {\n        this.picsList.push({ name: item.pid, url: \"http://\" + item.purl });\n      }\n      this.tid = this.product.type.tid;\n      this.downAge = this.ageConvert(this.product.downAge, 0);\n      this.upAge = this.ageConvert(this.product.upAge, 1);\n    }\n  }\n};\n</script>\n\n<style lang=\"less\">\n.disabled .el-upload--picture-card {\n  display: none;\n}\n.commodity-form {\n  min-width: 680px;\n  .select-type {\n    .el-input {\n      width: 300px !important;\n    }\n  }\n  .select-data {\n    .el-input {\n      width: 100px !important;\n      margin-left: 10px;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./editCommodity.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./editCommodity.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./editCommodity.vue?vue&type=template&id=e08ab7b4&\"\nimport script from \"./editCommodity.vue?vue&type=script&lang=js&\"\nexport * from \"./editCommodity.vue?vue&type=script&lang=js&\"\nimport style0 from \"./editCommodity.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}