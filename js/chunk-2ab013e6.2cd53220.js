(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ab013e6"],{"218f":function(e,t,r){"use strict";var o=r("de6f"),s=r.n(o);s.a},"4de4":function(e,t,r){"use strict";var o=r("23e7"),s=r("b727").filter,l=r("1dde"),a=r("ae40"),i=l("filter"),n=a("filter");o({target:"Array",proto:!0,forced:!i||!n},{filter:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},"95c2":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"permission-wrapper"},[r("card",{attrs:{title:"权限管理"}},[r("el-button",{staticClass:"card-btn",attrs:{size:"small",type:"primary"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("添加用户")]),e._v(" 角色选择:"),r("el-radio-group",{staticStyle:{"margin-left":"20px"},on:{change:e.changeRole},model:{value:e.role,callback:function(t){e.role=t},expression:"role"}},e._l(e.roleMap,(function(e,t){return r("el-radio-button",{key:t,attrs:{label:e.text}})})),1),r("el-checkbox-group",{attrs:{disabled:"老板"===e.role},model:{value:e.permissionList,callback:function(t){e.permissionList=t},expression:"permissionList"}},e._l(e.permissionMap,(function(t,o){return r("el-checkbox",{key:o,attrs:{label:t.value,border:""},on:{change:function(r){return e.changePermission(t.value)}}},[e._v(e._s(t.text))])})),1),r("el-table",{ref:"filterTable",staticStyle:{"margin-top":"20px"},attrs:{data:e.roleList,border:""}},[r("el-table-column",{attrs:{prop:"role",label:"角色",align:"center"}}),r("el-table-column",{attrs:{prop:"username",label:"用户名",align:"center"}}),r("el-table-column",{attrs:{label:"操作",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini"},on:{click:function(r){return e.logOut(t.$index,t.row)}}},[e._v("注销")])]}}])})],1),r("el-dialog",{attrs:{title:"新增用户",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.closeForm}},[r("el-form",{ref:"roleform",staticClass:"permission-form",attrs:{model:e.roleForm,"label-position":"left",rules:e.rules}},[r("el-form-item",{attrs:{label:"用户身份:","label-width":"90px",prop:"type"}},[r("el-select",{model:{value:e.roleForm.role,callback:function(t){e.$set(e.roleForm,"role",t)},expression:"roleForm.role"}},e._l(e.roleMap,(function(e){return r("el-option",{key:e.value,attrs:{label:e.text,value:e.text}})})),1)],1),r("el-form-item",{attrs:{label:"用户名:","label-width":"90px",prop:"username"}},[r("el-input",{staticClass:"form-input",attrs:{autocomplete:"off",placeholder:"请输入用户名"},model:{value:e.roleForm.username,callback:function(t){e.$set(e.roleForm,"username",t)},expression:"roleForm.username"}})],1),r("el-form-item",{attrs:{label:"密码:","label-width":"90px",prop:"password"}},[r("el-input",{staticClass:"form-input",attrs:{autocomplete:"off",placeholder:"请输入密码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm(t)}},model:{value:e.roleForm.password,callback:function(t){e.$set(e.roleForm,"password",t)},expression:"roleForm.password"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.commitRole}},[e._v("确 定")])],1)],1)],1)],1)},s=[],l=(r("4de4"),r("c975"),r("d3b7"),r("3ca3"),r("ddb0"),r("b85c")),a=r("ff86"),i={components:{card:a["a"]},data:function(){var e=function(e,t,r){""===t?r(new Error("请输入用户名")):r()},t=function(e,t,r){""===t?r(new Error("请输入密码")):r()};return{rules:{username:[{validator:e,trigger:"blur"}],password:[{validator:t,trigger:"blur"}]},permissionList:[],rolePermission:[],role:"",roleMap:[{text:"老板",value:"0"},{text:"总负责人",value:"1"},{text:"客服人员",value:"2"},{text:"仓库管理",value:"3"}],permissionMap:[{text:"商品管理",value:"0"},{text:"订单管理",value:"1"},{text:"运费管理",value:"2"},{text:"库存管理",value:"3"},{text:"会员管理",value:"4"},{text:"机构管理",value:"5"},{text:"历史数据分析",value:"6"}],allUser:[],dialogFormVisible:!1,roleForm:{role:"老板",username:"",password:""}}},computed:{roleList:function(){var e=this;return this.allUser.filter((function(t){return t.role==e.role}))}},methods:{closeForm:function(){this.$refs.roleform.resetFields()},logOut:function(e,t){var r=this;this.$axios({url:"/deleteUser",params:{userId:t.userId}}).then((function(e){200==e.data.code?(r.$message({type:"success",message:"注销成功"}),r.getUser()):r.$message({type:"error",message:e.data.msg})}))},commitRole:function(){var e=this;this.dialogFormVisible=!0,this.$refs["roleform"].validate((function(t){if(!t)return!1;e.$axios({url:"/addUser",method:"post",transformRequest:[function(e){return JSON.stringify(e)}],data:e.roleForm,headers:{"Content-Type":"application/json"}}).then((function(t){200==t.data.code?(e.$message({type:"success",message:"添加用户成功"}),e.getUser(),e.dialogFormVisible=!1):e.$message({type:"error",message:t.data.msg})}))}))},filterHandler:function(e,t,r){var o=r["property"];return t[o]===e},changeRole:function(){var e,t=Object(l["a"])(this.roleMap);try{for(t.s();!(e=t.n()).done;){var r=e.value;r.text==this.role&&(this.permissionList=this.rolePermission[r.value])}}catch(o){t.e(o)}finally{t.f()}},changePermission:function(e){var t=this;-1!==this.permissionList.indexOf(e)?this.$axios({url:"/addPerm",params:{permission:e,role:this.role}}).then((function(e){t.getPermission()})):this.$axios({url:"/deletePerm",params:{permission:e,role:this.role}}).then((function(e){t.getPermission()}))},getPermission:function(){var e=this;return this.$axios({url:"/getPermByRole"}).then((function(t){if(200==t.data.code){e.rolePermission=[];var r,o=Object(l["a"])(e.roleMap);try{for(o.s();!(r=o.n()).done;){var s=r.value;e.rolePermission.push(t.data.data[s.text])}}catch(a){o.e(a)}finally{o.f()}e.changeRole()}else e.$message({type:"error",message:"获取信息错误"})})).catch((function(t){e.$message({type:"error",message:"获取信息失败"})}))},getUser:function(){var e=this;return this.$axios({url:"/getAllUserInfo"}).then((function(t){200==t.data.code?e.allUser=t.data.data:e.$message({type:"error",message:"获取信息错误"})})).catch((function(t){e.$message({type:"error",message:"获取信息失败"})}))}},created:function(){var e=this;this.$openLoading(),this.role=this.roleMap[0].text,Promise.all([this.getPermission(),this.getUser()]).then((function(t){e.changeRole(),setTimeout((function(){e.$openLoading().close()}),200)}))}},n=i,u=(r("218f"),r("2877")),c=Object(u["a"])(n,o,s,!1,null,null,null);t["default"]=c.exports},de6f:function(e,t,r){}}]);
//# sourceMappingURL=chunk-2ab013e6.2cd53220.js.map